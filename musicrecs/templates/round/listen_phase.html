{% extends 'round/base.html' %}
{% import "bootstrap/wtf.html" as wtf %}

{% block round_nav %}
    {% if round.status != revealed %}
        <form
            method="post"
            action="{{ url_for('round_advance', long_id=round.long_id)}}"
            onsubmit="return confirmAndAdvance('Are you sure you want to reveal to all participants who recommended what?')";>
            <input class="btn btn-danger" style="white-space: normal;" type="submit" name="advance_to_revealed" value="Advance to the revealed phase">
        </form>
    {% endif %}
{% endblock %}

{% block round_content %}
        {% if playlist %}
            <div class="bg-light" style="padding: 15px; margin-top: 10px; margin-bottom: 10px;">
                <h4>The playlist</h4>
                <a href="{{playlist.link}}">
                    <div class="row bg-dark text-light" style="padding: 10px; margin-top: 10px; margin-bottom: 10px; margin-left: 10px; margin-right: 10px; display: inline-block;">
                        <div class="row">
                            {%if playlist.img_url %}
                                <div class="col col-auto">
                                    <img src="{{playlist.img_url}}"
                                        alt="{{playlist.name}}"
                                        style="width: {{playlist.IMG_DIMEN}}px; height:{{playlist.IMG_DIMEN}}px; border:0;">
                                </div>
                            {% endif %}
                            <div class="col" style="min-width: 200px">
                                <span class="align-middle">{{playlist.name}}</span>
                            </div>
                        </div>
                    </div>
                </a>
            </div>
        {% elif playlist_form %}
            <div class="bg-light" style="padding: 15px; margin-top: 10px; margin-bottom: 10px;">
                <h4>Create a playlist for this round</h4>
                {{ wtf.quick_form(playlist_form, method="post", action=url_for('round_create_playlist', long_id=round.long_id)) }}
            </div>
        {% endif %}
    </div>

    <div class="bg-light" style="padding: 15px; margin-top: 10px; margin-bottom: 10px;">
        <h4> The {{round.music_type.name}}s</h4>
        {% for user_name, music in music_submissions %}
            <a href="{{music.link}}">
                <div class="row bg-dark text-light" style="padding: 10px; margin-top: 10px; margin-bottom: 10px; margin-left: 10px; margin-right: 10px; display: inline-block;">
                    <div class="row">
                        <div class="col col-auto">
                            <img src="{{music.img_url}}"
                                alt="{{music.name}}"
                                style="width: {{music.IMG_DIMEN}}px; height:{{music.IMG_DIMEN}}px; border:0;">
                        </div>
                        <div class="col" style="min-width: 200px">
                            <span class="align-middle"><b>{{music.name}}</b> by {{music.get_artists_comma_separated()}}</span>
                        </div>
                    </div>
                    {% if round.status ==  revealed %}
                        <div class="align-bottom text-right font-italic">recommended by {{user_name}}</div>
                    {% endif %}
                </div>
            </a>
        {% endfor %}
    </div>
{% endblock %}